<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Teacher - Classroom Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="canvas-app.css" />
</head>
<body class="min-h-screen bg-gradient-to-br from-sky-100 via-white to-slate-100 p-6 text-slate-700">
  <div class="mx-auto flex w-full max-w-[1200px] flex-col gap-6">
    <header class="rounded-[28px] border border-slate-200 bg-white/80 p-6 shadow-[0_30px_70px_rgba(30,64,175,0.18)] backdrop-blur">
      <div class="flex flex-col gap-6 md:flex-row md:items-center md:justify-between">
        <div>
          <h1 class="text-3xl font-bold text-slate-900">Teacher Dashboard</h1>
          <p class="mt-2 max-w-xl text-sm text-slate-500">
            Monitor every student's canvas and annotate live with the shared toolbar.
          </p>
        </div>
        <div class="flex flex-col gap-4 sm:flex-row sm:items-center">
          <div class="flex items-center gap-3">
            <input
              type="text"
              id="sessionInput"
              value="TEST123"
              class="w-32 rounded-2xl border border-slate-200 bg-white px-4 py-2 text-sm font-semibold uppercase tracking-[0.3em] text-slate-700 shadow-inner focus:border-blue-400 focus:outline-none focus:ring-4 focus:ring-blue-100"
            />
            <button
              id="startSessionBtn"
              type="button"
              class="rounded-2xl bg-gradient-to-r from-blue-600 to-sky-500 px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-blue-900/25 transition hover:from-blue-500 hover:to-sky-400 focus:outline-none focus:ring-4 focus:ring-blue-200"
            >
              Start session
            </button>
          </div>
          <div
            id="status"
            class="inline-flex items-center justify-center rounded-full border border-blue-200 bg-blue-100 px-4 py-2 text-sm font-semibold text-blue-700"
          >
            Not connected
          </div>
        </div>
      </div>
      <div
        id="sessionInfo"
        class="mt-5 hidden items-center justify-between rounded-2xl border border-emerald-100 bg-emerald-50/70 px-4 py-3 text-sm font-semibold text-emerald-700"
      >
        <span>Session <span id="sessionCode" class="font-bold text-emerald-600"></span></span>
        <span><span id="studentCount" class="text-lg font-bold text-slate-900">0</span> students online</span>
      </div>
    </header>

    <div
      id="emptyState"
      class="flex flex-1 flex-col items-center justify-center rounded-[28px] border border-dashed border-slate-300 bg-white/70 p-12 text-center text-slate-500"
    >
      <h2 class="text-xl font-semibold text-slate-700">Waiting for students</h2>
      <p class="mt-2 max-w-sm text-sm text-slate-500">
        Share the session code so learners can join and draw in real time.
      </p>
    </div>

    <div id="students" class="grid grid-cols-1 gap-5 sm:grid-cols-2 xl:grid-cols-3"></div>
  </div>

  <div
    id="modal"
    class="invisible pointer-events-none fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur"
  >
    <div class="pointer-events-auto flex w-full max-w-[1150px] flex-col gap-6 rounded-[28px] border border-slate-200 bg-white/95 p-6 shadow-[0_45px_90px_rgba(30,64,175,0.2)]">
      <div class="flex flex-wrap items-start justify-between gap-4">
        <div>
          <h2 id="modalTitle" class="text-2xl font-semibold text-slate-900">Annotating Student</h2>
          <p class="text-sm text-slate-500">Use the toolbar to add notes directly onto the student's canvas.</p>
        </div>
        <button
          id="closeModal"
          type="button"
          class="inline-flex items-center justify-center rounded-2xl border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-600 shadow-sm transition hover:bg-slate-50 focus:outline-none focus:ring-4 focus:ring-slate-200"
        >
          Close
        </button>
      </div>
      <div class="flex flex-1 flex-col gap-6">
        <div class="flex-1 rounded-[28px] border border-slate-200 bg-slate-50 p-6 shadow-inner">
          <div class="canvas-app" id="teacherCanvasApp">
            <div class="wrap">
              <div class="topbar">
                <h2>Teacher Canvas</h2>
                <span class="status" id="teacherCanvasStatus" data-tone="ready">
                  <span class="dot" aria-hidden="true"></span>
                  <span id="teacherCanvasStatusText">Ready</span>
                </span>
              </div>
              <div class="card">
                <div class="toolbar" role="toolbar" aria-label="Teacher drawing controls">
                  <div class="group" role="group" aria-label="Ink colour">
                    <button class="swatch is-active" data-color="#111827" title="Black" style="background:#111827"></button>
                    <button class="swatch" data-color="#2563eb" title="Blue" style="background:#2563eb"></button>
                    <button class="swatch" data-color="#16a34a" title="Green" style="background:#16a34a"></button>
                    <button class="swatch" data-color="#ef4444" title="Red" style="background:#ef4444"></button>
                  </div>
                  <div class="group" role="group" aria-label="Tool">
                    <button class="btn is-active" data-tool="pen" title="Pen">Pen</button>
                    <button class="btn" data-tool="eraser" title="Eraser">Eraser</button>
                  </div>
                  <div class="group slider" role="group" aria-label="Brush size">
                    <label for="teacherBrush" class="pill">Size</label>
                    <input id="teacherBrush" type="range" min="1" max="12" value="2.2" step="0.2" />
                    <div class="preview-dot" id="teacherSizePreview" title="Preview"></div>
                    <span id="teacherSizeLabel" class="pill">2.2 px</span>
                  </div>
                  <div class="group" role="group" aria-label="History">
                    <button class="btn" id="teacherUndoBtn" disabled>Undo</button>
                    <button class="btn" id="teacherRedoBtn" disabled>Redo</button>
                    <button class="btn" id="teacherClearBtn" disabled>Clear</button>
                  </div>
                  <div class="group" role="group" aria-label="Input">
                    <button class="btn" id="teacherStylusBtn" aria-pressed="true">Stylus-only</button>
                  </div>
                </div>
                <div class="stage" id="teacherStage">
                  <canvas
                    id="teacherPad"
                    width="800"
                    height="600"
                    aria-label="Teacher drawing canvas (800 by 600)"
                  ></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    window.SUPABASE_URL = "https://eytswszeopdxmtxxbkrb.supabase.co";
    window.SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV5dHN3c3plb3BkeG10eHhia3JiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg1NTI5ODQsImV4cCI6MjA3NDEyODk4NH0.7skddGtrUoXluvK9JDS54bpmKCxVYeofzWATmJIgABE";
  </script>

  <script type="module" src="./teacher-app.js"></script>
</body>
</html>
